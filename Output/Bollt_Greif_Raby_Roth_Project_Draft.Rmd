---
output: 
  pdf_document:
    keep_tex: yes
    fig_caption: yes
    number_sections: yes
geometry: margin=2.54cm
title: Impacts of Land Use on Water Quality in Minnesota 
subtitle: https://github.com/lhr12/HDA_Project
author: Keith Bollt, Jake Greif, Felipe Raby-Amadori, & Lindsay Roth
abstract: "Abstract tbd"
fontsize: 12pt
mainfont: Times New Roman
editor_options: 
  chunk_output_type: console
---

\newpage
\tableofcontents 
\newpage
\listoftables 
\newpage
\listoffigures 
\newpage


```{r setup, include=FALSE}
getwd()

#load packages
library(tidyverse)
library(lubridate)
library(LAGOSNE)
library(sf)
library(maps)
library(mapview)
library(viridis)
library(ggplot2)
library(dplyr)
library(gridExtra)
library(grid)

theme_set(theme_classic())

```


# Research Question and Rationale

* Land use has a large impact on nutrient runoff into streams, lakes, and other water bodies
* Minnesota has wide variety of land uses.  Inlcudes large urban centers, natural lands, and agricultural area. 
* Nutrient management has been a challenge for states in the effort to control harmful algal blooms and coastal dead zones.
* Understanding the causes of nutrient problems will better inform management strategies.

Research questions:

1. What are the predictors of nutrients based on land use in watersheds in the state of Minnesota?

2. How do you characterize seasonal variation between the predictors of nutrients?

Goals:

* Determine how land use, watershed size, and ecoregion explain variation in nutrient loading indicators.
* Discern whether there a seasonal trends in nutrient loading indicators based on land use types, watershed size, and ecoregion.
* Provide insight to inform decisions about nutrient managment practices based on land use types, watershed size, and ecoregion.

\newpage

# Dataset Information

The data used in this analysis include data from the Lake Multi-Scaled Geospatial and Temporal Database (LAGOSNE) and the EPA ecoregion spatial datasets.

LAGOSNE is a collection of several data modules that contain information on lakes in the northern United States. The modules contain data from thousands of lakes in 17 states in the northeastern and midwestern United States, from Missouri to Maine. The dataset includes a complete list of all lakes bigger than 4 hectacres in the 17 state area, and water quality data on a large number of lakes, spanning every state. 

Ecoregions are used by planning managers to understand the type of land use that occurs in different regions of the United States. There are different levels of ecoregions. Level I divides North America into 15 ecological regions, while Level IV offers fine ecological resolution for each state. This data was published by the U.S. EPA Office of Research and Development (ORD) - National Health and Environmental Effects Research Laboratory (NHEERL). For the purposes of our project, we selected Level III ecoregions because in our judgement, Level IV ecoregions are more specific than the type of analysis we are performing calls for.

```{r ,echo=FALSE}
Variables.table <- read.csv("./Output/Variable_Descriptions_Table.csv")
library(knitr)
kable(Variables.table)
```

\newpage

# Exploratory Data Analysis and Wrangling

```{r Setup_Load_Data}
#load LAGOS data
LAGOSdata <- lagosne_load()

# creating specific lagos files
LAGOSstate <- LAGOSdata$state
LAGOSlocus <- LAGOSdata$locus
LAGOSnutrient <- LAGOSdata$epi_nutr
LAGOSiwslulc <- LAGOSdata$iws.lulc
LAGOSiws <- LAGOSdata$iws
```

```{r MN_Nutrient_Data}
#State 14: Minnesota
LAGOSlocus.MN <- LAGOSlocus %>% filter (state_zoneid == "State_14")
LAGOSnutrient.MN <- LAGOSlocus.MN %>%
  left_join(LAGOSnutrient, by = "lagoslakeid") 
```

```{r Joining_MN_Nutrient_lulc}
#getting the area of the iws
LAGOSiws.area <- select(LAGOSiws, "lagoslakeid", "iws_ha")

#joining MN locus with iwslulc and adding the area of IWS
LAGOSiws.MN <- LAGOSlocus.MN %>% 
  left_join(LAGOSiwslulc, by = "lagoslakeid") %>%
  left_join(LAGOSiws.area, by = "lagoslakeid")

##selecting 2011 lulc
LAGOSiws2011.MN <- LAGOSiws.MN %>% 
  select(lagoslakeid,state_zoneid, lake_area_ha, iws_ha,
         iws_nlcd2011_pct_11, iws_nlcd2011_pct_21, iws_nlcd2011_pct_22,
         iws_nlcd2011_pct_23, iws_nlcd2011_pct_24, iws_nlcd2011_pct_31,
         iws_nlcd2011_pct_41, iws_nlcd2011_pct_42, iws_nlcd2011_pct_43,
         iws_nlcd2011_pct_52, iws_nlcd2011_pct_71, iws_nlcd2011_pct_81,
         iws_nlcd2011_pct_82, iws_nlcd2011_pct_90, iws_nlcd2011_pct_95)
```

```{r, Filter_Nutrient_Dates}
#filtering state nutrient data #FRA. We can expand this range
LAGOSnutrient.MN.skinny <- LAGOSnutrient.MN %>%
  filter(sampledate > "2008-12-31" & sampledate < "2015-01-01")

```

```{r, Joined_MN_df}
##Joining iws.lulc and nutrient
LAGOSiws.nutrient.2011.MN <-  left_join(LAGOSnutrient.MN.skinny,
                                        LAGOSiws2011.MN, by =
                                          c("lagoslakeid", "lake_area_ha")) 

LAGOSiws.nutrient.2011.MN <- LAGOSiws.nutrient.2011.MN %>%
  select(lagoslakeid, nhd_lat, nhd_long, lake_area_ha, lake_perim_meters,
         iws_zoneid, iws_ha, state_zoneid.x, elevation_m, sampledate, chla,secchi, 
         iws_nlcd2011_pct_11, iws_nlcd2011_pct_21, iws_nlcd2011_pct_22, 
         iws_nlcd2011_pct_23, iws_nlcd2011_pct_24, iws_nlcd2011_pct_31, 
         iws_nlcd2011_pct_41, iws_nlcd2011_pct_42, iws_nlcd2011_pct_43, 
         iws_nlcd2011_pct_52, iws_nlcd2011_pct_71, iws_nlcd2011_pct_81, 
         iws_nlcd2011_pct_82, iws_nlcd2011_pct_90, iws_nlcd2011_pct_95)
```

Visualizing the Secchi and Chla data.

```{r, Visualize_data}

knitr::opts_chunk$set(cache=TRUE, error=FALSE, fig.cap = "This plot provides a sense of how secchi depth measurements are distributed between and within years, as well as the general range of secchi depth measurements. Sampling occurs during the middle portion of each year, and ceases during the winter season.", message=FALSE, warning=FALSE)

ggplot(LAGOSiws.nutrient.2011.MN, 
       aes(x = sampledate, y = secchi)) +
  geom_point(alpha = 0.2) +
  labs(y = "Secchi Depth (m)", x = "Year") +
  ggtitle("Secchi Depth vs Time") +
  theme(plot.title = element_text(hjust = 0.5))
```

```{r}

knitr::opts_chunk$set(cache=TRUE, error=FALSE, fig.cap = "Chlorophyll a vs. Time. This plot provides a sense of how chlorophyll a measurements are distributed between and within years, as well as the general range of chlorophyll a measurements. Sampling occurs during the middle portion of each year, and ceases during the winter season.", message=FALSE, warning=FALSE)

ggplot(LAGOSiws.nutrient.2011.MN, 
       aes(x = sampledate, y = chla)) +
  geom_point(alpha = 0.2) +
  labs(y = "Chlorophyll a (ug/L)", x = "Year") +
  ggtitle("Chlorophyll a vs Time") +
  theme(plot.title = element_text(hjust = 0.5))
```

Creating full data frame.

```{r Create_Full_df}
LAGOS.MN.processed <- LAGOSiws.nutrient.2011.MN %>%
  mutate(IntenseUrban.pct = iws_nlcd2011_pct_23 + iws_nlcd2011_pct_24,
         OpenUrban.pct = iws_nlcd2011_pct_21,
         Barren.pct = iws_nlcd2011_pct_31,
         Forest.pct = iws_nlcd2011_pct_41 + iws_nlcd2011_pct_42 + iws_nlcd2011_pct_43,
         GrassShrub.pct = iws_nlcd2011_pct_52 + iws_nlcd2011_pct_71,
         Wetland.pct = iws_nlcd2011_pct_90 + iws_nlcd2011_pct_95,
         Pasture.pct =  iws_nlcd2011_pct_81,
         RowCrop.pct = iws_nlcd2011_pct_82) %>%
  select(-c(iws_nlcd2011_pct_11, iws_nlcd2011_pct_21, iws_nlcd2011_pct_22, 
            iws_nlcd2011_pct_23, iws_nlcd2011_pct_24, iws_nlcd2011_pct_31, 
            iws_nlcd2011_pct_41, iws_nlcd2011_pct_42, iws_nlcd2011_pct_43, 
            iws_nlcd2011_pct_52, iws_nlcd2011_pct_71, iws_nlcd2011_pct_81, 
            iws_nlcd2011_pct_82, iws_nlcd2011_pct_90, iws_nlcd2011_pct_95)) %>%
  na.omit() %>%
  mutate(LakeIWS.Ratio = lake_area_ha/iws_ha) %>%
  mutate(DOY = yday(sampledate))
```

```{r adding a season column}
#We are creating growing seasons; early, prime, late. 
#They will be based off of water temperature and day of year. 
#We choose May 15 and October 1 because these are arbitrary but 
#approximate bookends to the prime growing season.

LAGOS.MN.processed$EarlyTrue <- 
  LAGOS.MN.processed$DOY < 136 #Before May 15
LAGOS.MN.processed$PrimeTrue <- 
  LAGOS.MN.processed$DOY >=136 & LAGOS.MN.processed$DOY <= 273 #May 15 to September 30
LAGOS.MN.processed$LateTrue <- 
  LAGOS.MN.processed$DOY > 273  #October 1 and later

LAGOS.MN.processed$EarlyTrue <- 
  ifelse(LAGOS.MN.processed$EarlyTrue == TRUE, "Early", "No")
LAGOS.MN.processed$PrimeTrue <- 
  ifelse(LAGOS.MN.processed$PrimeTrue == TRUE, "Prime", "No")
LAGOS.MN.processed$LateTrue <- 
  ifelse(LAGOS.MN.processed$LateTrue == TRUE, "Late", "No")

LAGOS.MN.processed$Season <- LAGOS.MN.processed$EarlyTrue == "Early"
  
LAGOS.MN.processed$Season[LAGOS.MN.processed$EarlyTrue == "Early"] <- "Early"
LAGOS.MN.processed$Season[LAGOS.MN.processed$PrimeTrue == "Prime"] <- "Prime"
LAGOS.MN.processed$Season[LAGOS.MN.processed$LateTrue == "Late"] <- "Late"

LAGOS.MN.processed  <- LAGOS.MN.processed %>%
  select(-c(EarlyTrue, PrimeTrue, LateTrue))
```

```{r Adding_Ecoregions}
LAGOS.MN.processed.sf <- st_as_sf(LAGOS.MN.processed, 
                                  coords = c("nhd_long", "nhd_lat"), crs = 4326)

LAGOS.MN.processed.UTM.sf <- st_transform(LAGOS.MN.processed.sf, crs=26917)

MN.Ecoregions.sf <- st_read('./Data/Raw/mn_eco_l3.shp')

#Selecting level 3 ecoregions names
MN.Ecoregions.sf <- select(MN.Ecoregions.sf, US_L3NAME)
colnames(MN.Ecoregions.sf)[1] <- "Ecoregion"

MN.Ecoregions.UTM.sf <- st_transform(MN.Ecoregions.sf, crs=26917)

LAGOS.MN.processed.sf <- st_join(LAGOS.MN.processed.UTM.sf, MN.Ecoregions.UTM.sf)
```

```{r Creating_Seasons_dfs}
#Creating sf seasons files
LAGOS.MN.processed.Early.sf <- filter(LAGOS.MN.processed.sf, Season == "Early")
LAGOS.MN.processed.Prime.sf <- filter(LAGOS.MN.processed.sf, Season == "Prime")
LAGOS.MN.processed.Late.sf <- filter(LAGOS.MN.processed.sf, Season == "Late")

#Creating regular season files (doesn't have ecoregions column)
LAGOS.MN.processed.Early <- filter(LAGOS.MN.processed, Season == "Early")
LAGOS.MN.processed.Prime <- filter(LAGOS.MN.processed, Season == "Prime")
LAGOS.MN.processed.Late <- filter(LAGOS.MN.processed, Season == "Late")

#To look at the statistics
summary(LAGOS.MN.processed.Early.sf$chla)
summary(LAGOS.MN.processed.Prime.sf$chla)
summary(LAGOS.MN.processed.Late.sf$chla)

summary(LAGOS.MN.processed.Early.sf$secchi)
summary(LAGOS.MN.processed.Prime.sf$secchi)
summary(LAGOS.MN.processed.Late.sf$secchi)
```

Visualizing preliminary trends with scatterplots.

```{r scatterplots}
#Exploring some preliminary trends for Late Season (Highest Mean Chla and Lowest Mean Secchi Depth)

knitr::opts_chunk$set(cache=TRUE, error=FALSE, fig.cap = "These plots shows that there are trends in secchi depth relative to the given land uses during the 'Late Season'. The presence of trends supports the inclusion of the above land uses in the analysis. Note that the x-axes are on different scales.", message=FALSE, warning=FALSE)

secchi.int.urb.late <- ggplot(LAGOS.MN.processed.Late.sf, aes(x = IntenseUrban.pct, y = secchi)) +
geom_point(alpha = 0.5) +
geom_smooth(method=lm, se=FALSE) +
xlab(expression("% Intense Urban")) +
ylab(expression("Secchi Depth (m)")) +
#ggtitle("% Intense Urban vs Secchi Depth, Late Season") +
theme(plot.title = element_text(hjust = 0.5))

secchi.open.urb.late <- ggplot(LAGOS.MN.processed.Late.sf, aes(x = OpenUrban.pct, y = secchi)) +
geom_point(alpha = 0.5) +
geom_smooth(method=lm, se=FALSE) +
xlab(expression("% Open Urban")) +
ylab(expression("")) +
#ggtitle("% Open Urban vs Secchi Depth, Late Season") +
theme(plot.title = element_text(hjust = 0.5))

secchi.barren.late <- ggplot(LAGOS.MN.processed.Late.sf, aes(x = Barren.pct, y = secchi)) +
geom_point(alpha = 0.5) +
geom_smooth(method=lm, se=FALSE) +
xlab(expression("% Barren")) +
ylab(expression("")) +
#ggtitle("% Barren Land vs Secchi Depth, Late Season") +
theme(plot.title = element_text(hjust = 0.5))

secchi.forest.late <- ggplot(LAGOS.MN.processed.Late.sf, aes(x = Forest.pct, y = secchi)) +
geom_point(alpha = 0.5) +
geom_smooth(method=lm, se=FALSE) +
xlab(expression("% Forest")) +
ylab(expression("Secchi Depth (m)")) +
#ggtitle("% Forest vs Secchi Depth Scatterplot, Late Season") +
theme(plot.title = element_text(hjust = 0.5))

secchi.grass.shrub.late <- ggplot(LAGOS.MN.processed.Late.sf, aes(x = GrassShrub.pct, y = secchi)) +
geom_point(alpha = 0.5) +
geom_smooth(method=lm, se=FALSE) +
xlab(expression("% Grass-Shrub")) +
ylab(expression("")) +
#ggtitle("% Grass-Shrub vs Secchi Depth, Late Season") +
theme(plot.title = element_text(hjust = 0.5))

secchi.wet.late <- ggplot(LAGOS.MN.processed.Late.sf, aes(x = Wetland.pct, y = secchi)) +
geom_point(alpha = 0.5) +
geom_smooth(method=lm, se=FALSE) +
xlab(expression("% Wetland")) +
ylab(expression("")) +
#ggtitle("% Wetland vs Secchi Depth, Late Season") +
theme(plot.title = element_text(hjust = 0.5))

secchi.past.late <- ggplot(LAGOS.MN.processed.Late.sf, aes(x = Pasture.pct, y = secchi)) +
geom_point(alpha = 0.5) +
geom_smooth(method=lm, se=FALSE) +
xlab(expression("% Pasture")) +
ylab(expression("Secchi Depth (m)")) +
#ggtitle("% Pasture vs Secchi Depth, Late Season") +
theme(plot.title = element_text(hjust = 0.5))

secchi.row.crop.late <- ggplot(LAGOS.MN.processed.Late.sf, aes(x = RowCrop.pct, y = secchi)) +
geom_point(alpha = 0.5) +
geom_smooth(method=lm, se=FALSE) +
xlab(expression("% Row Crops")) +
ylab(expression("")) +
#ggtitle("% Row Crops vs Secchi Depth, Late Season") +
theme(plot.title = element_text(hjust = 0.5))

title1 = grid.text("Secchi Depth vs. % Land Use")
grid.arrange(secchi.int.urb.late, secchi.open.urb.late, secchi.barren.late,
             secchi.forest.late, secchi.grass.shrub.late, secchi.wet.late,
             secchi.past.late, secchi.row.crop.late, top = title1)
```

```{r}

knitr::opts_chunk$set(cache=TRUE, error=FALSE, fig.cap = "These plots shows that there are trends in chlorophyll a relative to the given land uses during the 'Late Season'. The presence of trends supports the inclusion of the above land uses in the analysis.", message=FALSE, warning=FALSE)

chla.int.urb.late <- ggplot(LAGOS.MN.processed.Late.sf, aes(x = IntenseUrban.pct, y = chla)) +
geom_point() +
geom_smooth(method=lm, se=FALSE) +
xlab(expression("% Intense Urban")) +
ylab(expression("chla (mg/L)")) +
ggtitle("% Intense Urban vs Chla Scatterplot, Late Season") +
theme(plot.title = element_text(hjust = 0.5))

chla.forest.late <- ggplot(LAGOS.MN.processed.Late.sf, aes(x = Forest.pct, y = chla)) +
geom_point() +
geom_smooth(method=lm, se=FALSE) +
xlab(expression("% Forest")) +
ylab(expression("chla (mg/L)")) +
ggtitle("% Forest vs Chla Scatterplot, Late Season") +
theme(plot.title = element_text(hjust = 0.5))

chla.row.crop.late <- ggplot(LAGOS.MN.processed.Late.sf, aes(x = RowCrop.pct, y = chla)) +
geom_point() +
geom_smooth(method=lm, se=FALSE) +
xlab(expression("% Row Crops")) +
ylab(expression("chla (mg/L)")) +
ggtitle("% Row Crops vs Chla Scatterplot, Late Season") +
theme(plot.title = element_text(hjust = 0.5))


```

Late season has the highest mean Chla concentrations and lowest Secchi depth, so next we explore spatially the variables only for this season (to minimize maps output).

```{r summary.for.late.season}
LAGOS.MN.Summary.Late <- LAGOS.MN.processed.Late %>%
group_by(lagoslakeid) %>%
summarise(secchi.mean = mean(secchi),
          chla.mean = mean(chla),
          lake.area = mean(lake_area_ha),
          iws.area = mean(iws_ha),
          LakeIWS.Ratio = mean(LakeIWS.Ratio),
          Water.pct = mean(Water.pct),
          Urban.pct = mean(Urban.pct),
          Undeveloped.pct = mean(Undeveloped.pct),
          Ag.pct = mean(Ag.pct),
          Lat = mean(nhd_lat),
          Long = mean(nhd_long)
          ) %>%
  drop_na()

#SF file with the summary
LAGOS.MN.Summary.Late.sf <- st_as_sf(LAGOS.MN.Summary.Late, 
                                     coords = c("Long", "Lat"), crs = 4326)

#Loading the MN state boundary  
# generate a map of U.S. states
states <- st_as_sf(map(database = "state", plot = FALSE, 
                       fill = TRUE, col = "white"))

# filter MN
states.MN <- filter(states, ID %in%
c("minnesota"))

secchiplot1.Late.MN <- ggplot() +
  geom_sf(data = states.MN, fill = "white") +
  geom_sf(data = LAGOS.MN.Summary.Late.sf, 
          aes(size = Undeveloped.pct, color = secchi.mean),
          alpha = 0.4, show.legend = "point") +
  scale_color_viridis_c(option = "inferno") +
  labs(color = "Average \n Secchi \n Depth (m)", 
       size = "Undeveloped \n Area \n %") +
  theme(legend.position = "right", legend.text = element_text(size = 7),
        legend.title = element_text(size = 8),
        legend.margin = margin(0,0,0,0)) 
print(secchiplot1.Late.MN)

secchiplot2.Late.MN <- ggplot() +
  geom_sf(data = states.MN, fill = "white") +
  geom_sf(data = LAGOS.MN.Summary.Late.sf, 
          aes(size = Urban.pct, color = secchi.mean),
          alpha = 0.4, show.legend = "point") +
  scale_color_viridis_c(option = "inferno") +
  labs(color = "Average \n Secchi \n Depth (m)", 
       size = "Urban \n Area \n %") +
  theme(legend.position = "right", legend.text = element_text(size = 7),
        legend.title = element_text(size = 8),
        legend.margin = margin(0,0,0,0)) 
print(secchiplot2.Late.MN)

secchiplot3.Late.MN <- ggplot() +
  geom_sf(data = states.MN, fill = "white") +
  geom_sf(data = LAGOS.MN.Summary.Late.sf, 
          aes(size = Ag.pct, color = secchi.mean),
          alpha = 0.4, show.legend = "point") +
  scale_color_viridis_c(option = "inferno") +
  labs(color = "Average \n Secchi \n Depth (m)", 
       size = "Agricultural \n Area \n %") +
  theme(legend.position = "right", legend.text = element_text(size = 7),
        legend.title = element_text(size = 8),
        legend.margin = margin(0,0,0,0)) 
print(secchiplot3.Late.MN)

chlaplot1.Late.MN <- ggplot() +
  geom_sf(data = states.MN, fill = "white") +
  geom_sf(data = LAGOS.MN.Summary.Late.sf, 
          aes(size = Undeveloped.pct, color = chla.mean),
          alpha = 0.4, show.legend = "point") +
  scale_color_viridis_c(option = "inferno") +
  labs(color = "Average \n Chla \n Depth (m)", 
       size = "Undeveloped \n Area \n %") +
  theme(legend.position = "right", legend.text = element_text(size = 7),
        legend.title = element_text(size = 8),
        legend.margin = margin(0,0,0,0)) 
print(chlaplot1.Late.MN)

chlaplot2.Late.MN <- ggplot() +
  geom_sf(data = states.MN, fill = "white") +
  geom_sf(data = LAGOS.MN.Summary.Late.sf, 
          aes(size = Urban.pct, color = chla.mean),
          alpha = 0.4, show.legend = "point") +
  scale_color_viridis_c(option = "inferno") +
  labs(color = "Average \n Chla \n Depth (m)", 
       size = "Urban \n Area \n %") +
  theme(legend.position = "right", legend.text = element_text(size = 7),
        legend.title = element_text(size = 8),
        legend.margin = margin(0,0,0,0)) 
print(chlaplot2.Late.MN)

chlaplot3.Late.MN <- ggplot() +
  geom_sf(data = states.MN, fill = "white") +
  geom_sf(data = LAGOS.MN.Summary.Late.sf, 
          aes(size = Ag.pct, color = chla.mean),
          alpha = 0.4, show.legend = "point") +
  scale_color_viridis_c(option = "inferno") +
  labs(color = "Average \n Chla \n Depth (m)", 
       size = "Agricultural \n Area \n %") +
  theme(legend.position = "right", legend.text = element_text(size = 7),
        legend.title = element_text(size = 8),
        legend.margin = margin(0,0,0,0)) 
print(secchiplot3.Late.MN)
```

```{r writing_csv}
st_geometry(LAGOS.MN.processed.Early.sf) <- NULL
write.csv(x =  LAGOS.MN.processed.Early.sf, row.names = FALSE,
          file =  "./data/processed/LAGOS.MN.processed.Early.csv")

st_geometry(LAGOS.MN.processed.Prime.sf) <- NULL
write.csv(x =  LAGOS.MN.processed.Prime.sf, row.names = FALSE,
          file =  "./data/processed/LAGOS.MN.processed.Prime.csv")

st_geometry(LAGOS.MN.processed.Late.sf) <- NULL
write.csv(x =  LAGOS.MN.processed.Late.sf, row.names = FALSE,
          file =  "./data/processed/LAGOS.MN.processed.Late.csv")
```

\newpage

# Analysis

* First we will create correlation plots in order to eliminate variables with a correlation greater than 0.8.
* Then we will run Shapiro-Wilkes tests to determine normality and the need for possible data transformations.
* After determining the distributions of the data, we will generate mixed effect linear models with chlorophyll a and secchi depth as response variables, land use and lake-watershed area ratio as fixed effects, and ecoregion as a random effect.

Final figures will include:

* 6 maps of the state, each showing the relationship between land use and both response variables. Ecoregion will be included as a base layer for each map.
* Scatter plots showing the strongest relationships between land use and the response variables.
* Table showing results of linear model.

\newpage

# Summary and Conclusions

* Conclusions will include a discussion of our results within the context of MN nutrient management plan.

