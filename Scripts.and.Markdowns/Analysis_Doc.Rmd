---
title: "Analysis_Doc"
author: "Lindsay Roth"
date: "11/15/2019"
output: pdf_document
editor_options: 
  chunk_output_type: console
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```


```{r Setup and load data}
getwd()

#load packages
suppressMessages(library(tidyverse))
library(ggplot2)
library(dplyr)
library(RColorBrewer)
library(viridis)
library(knitr)
library(lubridate)
library(lme4)
library(nlme)
library(trend)
library(gridExtra)
library(corrplot)
library(car)
library(bestNormalize)
library(stats)
library(LAGOSNE)
library(sf)
library(maps)
library(mapview)
library(lme4)

source("./Scripts.and.Markdowns/pair.fun.R")


#load data
#Early
LAGOS.MN.processed.Early <- read.csv("./data/processed/LAGOS.MN.processed.Early.csv")
#Late
LAGOS.MN.processed.Late <-read.csv("./data/processed/LAGOS.MN.processed.Late.csv")
#Prime
LAGOS.MN.processed.Prime <-read.csv("./data/processed/LAGOS.MN.processed.Prime.csv")
# #Full
# LAGOS.MN.processed.Full <-read.csv("./data/processed/LAGOS_MN_Full2.csv")


#set theme
theme_set(theme_classic())
```



```{r correlation and distributions}
early.model.variables <- LAGOS.MN.processed.Early %>%
  select(chla, secchi, IntenseUrban.pct, OpenUrban.pct, Barren.pct, Forest.pct,
         GrassShrub.pct, Wetland.pct, Pasture.pct, RowCrop.pct, LakeIWS.Ratio, Ecoregion)
prime.model.variables <- LAGOS.MN.processed.Prime %>%
  select(chla, secchi, IntenseUrban.pct, OpenUrban.pct, Barren.pct, Forest.pct,
         GrassShrub.pct, Wetland.pct, Pasture.pct, RowCrop.pct, LakeIWS.Ratio, Ecoregion)
late.model.variables <- LAGOS.MN.processed.Late %>%
  select(chla, secchi, IntenseUrban.pct, OpenUrban.pct, Barren.pct, Forest.pct,
         GrassShrub.pct, Wetland.pct, Pasture.pct, RowCrop.pct, LakeIWS.Ratio, Ecoregion)

colnames(LAGOS.MN.processed.Early)

pairs(early.model.variables, lower.panel = panel.smooth, 
      upper.panel = panel.cor, diag.panel = panel.hist)
pairs(prime.model.variables, lower.panel = panel.smooth, 
      upper.panel = panel.cor, diag.panel = panel.hist)
pairs(late.model.variables, lower.panel = panel.smooth, 
      upper.panel = panel.cor, diag.panel = panel.hist)

sapply(LAGOS.MN.processed.Early, summary)
sapply(LAGOS.MN.processed.Prime, summary)
sapply(LAGOS.MN.processed.Late, summary)

```

```{r Normality tests}
#test for departures multivariate normality

qqnorm(LAGOS.MN.processed.Early$chla)
qqline(LAGOS.MN.processed.Early$chla)
shapiro.test(LAGOS.MN.processed.Early$chla)
bestNormalize(LAGOS.MN.processed.Early$chla) #log gets it closest
qqnorm(log(LAGOS.MN.processed.Early$chla))
qqline(log(LAGOS.MN.processed.Early$chla))
shapiro.test(log(LAGOS.MN.processed.Early$chla)) #still not normal but looks a lot better

qqnorm(LAGOS.MN.processed.Early$secchi)
qqline(LAGOS.MN.processed.Early$secchi)
shapiro.test(LAGOS.MN.processed.Early$secchi)
bestNormalize(LAGOS.MN.processed.Early$secchi) #log slightly better than sqrt
qqnorm(log(LAGOS.MN.processed.Early$secchi))
qqline(log(LAGOS.MN.processed.Early$secchi))
shapiro.test(log(LAGOS.MN.processed.Early$secchi)) #still not normal but looks a lot better


qqnorm(LAGOS.MN.processed.Early$IntenseUrban.pct)
qqline(LAGOS.MN.processed.Early$IntenseUrban.pct)
shapiro.test(LAGOS.MN.processed.Early$IntenseUrban.pct)
bestNormalize(LAGOS.MN.processed.Early$IntenseUrban.pct) #nothing makes it close to normal

qqnorm(LAGOS.MN.processed.Early$OpenUrban.pct)
qqline(LAGOS.MN.processed.Early$OpenUrban.pct)
shapiro.test(LAGOS.MN.processed.Early$OpenUrban.pct)
bestNormalize(LAGOS.MN.processed.Early$OpenUrban.pct) #nothing makes it close to normal

qqnorm(LAGOS.MN.processed.Early$Barren.pct)
qqline(LAGOS.MN.processed.Early$Barren.pct)
shapiro.test(LAGOS.MN.processed.Early$Barren.pct)
bestNormalize(LAGOS.MN.processed.Early$Barren.pct) #nothing makes it close to normal

qqnorm(LAGOS.MN.processed.Early$Forest.pct)
qqline(LAGOS.MN.processed.Early$Forest.pct)
shapiro.test(LAGOS.MN.processed.Early$Forest.pct)
bestNormalize(LAGOS.MN.processed.Early$Forest.pct) #sqrt best
qqnorm(sqrt(LAGOS.MN.processed.Early$Forest.pct))
qqline(sqrt(LAGOS.MN.processed.Early$Forest.pct))
shapiro.test(sqrt(LAGOS.MN.processed.Early$Forest.pct)) #not much better

qqnorm(LAGOS.MN.processed.Early$GrassShrub.pct)
qqline(LAGOS.MN.processed.Early$GrassShrub.pct)
shapiro.test(LAGOS.MN.processed.Early$GrassShrub.pct)
bestNormalize(LAGOS.MN.processed.Early$GrassShrub.pct) #nothing makes it close to normal

qqnorm(LAGOS.MN.processed.Early$Wetland.pct)
qqline(LAGOS.MN.processed.Early$Wetland.pct)
shapiro.test(LAGOS.MN.processed.Early$Wetland.pct)
bestNormalize(LAGOS.MN.processed.Early$Wetland.pct) #nothing makes it close to normal

qqnorm(LAGOS.MN.processed.Early$Pasture.pct)
qqline(LAGOS.MN.processed.Early$Pasture.pct)
shapiro.test(LAGOS.MN.processed.Early$Pasture.pct)
bestNormalize(LAGOS.MN.processed.Early$Pasture.pct) #nothing makes it close to normal

qqnorm(LAGOS.MN.processed.Early$RowCrop.pct)
qqline(LAGOS.MN.processed.Early$RowCrop.pct)
shapiro.test(LAGOS.MN.processed.Early$RowCrop.pct)
bestNormalize(LAGOS.MN.processed.Early$RowCrop.pct) #nothing makes it close to normal


```


```{r No interaction models}
#Early Season
early.chla.model1 <- lm(log(chla) ~ IntenseUrban.pct + OpenUrban.pct + 
                          Barren.pct + Forest.pct + GrassShrub.pct + Wetland.pct + 
                          Pasture.pct + RowCrop.pct + LakeIWS.Ratio + factor(Ecoregion), 
                        data = LAGOS.MN.processed.Early)
summary(early.chla.model1)
step(early.chla.model1) #openurban, forest, grassshrub, wetland, pasture, rowcrop, lakeratio, ecoregion
aov(early.chla.model1)

early.chla.model1.2 <- lm(log(chla) ~ IntenseUrban.pct + OpenUrban.pct + 
                          Forest.pct + GrassShrub.pct + Wetland.pct + 
                          Pasture.pct + RowCrop.pct + LakeIWS.Ratio + factor(Ecoregion), 
                        data = LAGOS.MN.processed.Early)
summary(early.chla.model1.2)

early.chla.model1.3 <- lm(log(chla) ~ OpenUrban.pct + 
                          Forest.pct + GrassShrub.pct + Wetland.pct + 
                          Pasture.pct + RowCrop.pct + LakeIWS.Ratio + factor(Ecoregion), 
                        data = LAGOS.MN.processed.Early)
summary(early.chla.model1.3)

early.chla.model1.4 <- lm(log(chla) ~ OpenUrban.pct + 
                          Forest.pct + GrassShrub.pct + 
                          Pasture.pct + RowCrop.pct + LakeIWS.Ratio + factor(Ecoregion), 
                        data = LAGOS.MN.processed.Early)
summary(early.chla.model1.4)

early.chla.model1.5 <- lm(log(chla) ~ OpenUrban.pct + 
                          Forest.pct +
                          Pasture.pct + RowCrop.pct + LakeIWS.Ratio + factor(Ecoregion), 
                        data = LAGOS.MN.processed.Early)
summary(early.chla.model1.5)
#remaining lulc significant, not sure what to do with ecoregion
#adjusted r-squared 0.1043

AIC(early.chla.model1, early.chla.model1.2, early.chla.model1.3, early.chla.model1.4, early.chla.model1.5)
#lowest AIC model 5
plot(early.chla.model1.5)

par(mfrow = c(2,2))
plot(early.chla.model1) #this looks great!!!



early.secchi.model1 <- lm(log(secchi) ~ IntenseUrban.pct + OpenUrban.pct + 
                          Barren.pct + Forest.pct + GrassShrub.pct + Wetland.pct + 
                          Pasture.pct + RowCrop.pct + LakeIWS.Ratio + factor(Ecoregion), 
                        data = LAGOS.MN.processed.Early)
summary(early.secchi.model1)
step(early.secchi.model1) #intenseurban, openurban, barren, forest, grassshrub, wetland, pasture, lakeratio, ecoregion

early.secchi.model1.2 <- lm(log(secchi) ~ IntenseUrban.pct + OpenUrban.pct + 
                          Barren.pct + Forest.pct + GrassShrub.pct + Wetland.pct + 
                          Pasture.pct + LakeIWS.Ratio + factor(Ecoregion), 
                        data = LAGOS.MN.processed.Early)
summary(early.secchi.model1.2)

early.secchi.model1.3 <- lm(log(secchi) ~ OpenUrban.pct + 
                          Barren.pct + Forest.pct + GrassShrub.pct + Wetland.pct + 
                          Pasture.pct + LakeIWS.Ratio + factor(Ecoregion), 
                        data = LAGOS.MN.processed.Early)
summary(early.secchi.model1.3)

early.secchi.model1.4 <- lm(log(secchi) ~ OpenUrban.pct + 
                          Barren.pct + Forest.pct + GrassShrub.pct + Wetland.pct + 
                          LakeIWS.Ratio + factor(Ecoregion), 
                        data = LAGOS.MN.processed.Early)
summary(early.secchi.model1.4)

early.secchi.model1.5 <- lm(log(secchi) ~
                          Barren.pct + Forest.pct + GrassShrub.pct + Wetland.pct + 
                          LakeIWS.Ratio + factor(Ecoregion), 
                        data = LAGOS.MN.processed.Early)
summary(early.secchi.model1.5)

early.secchi.model1.6 <- lm(log(secchi) ~
                          Forest.pct + GrassShrub.pct + Wetland.pct + 
                          LakeIWS.Ratio + factor(Ecoregion), 
                        data = LAGOS.MN.processed.Early)
summary(early.secchi.model1.6)

early.secchi.model1.7 <- lm(log(secchi) ~
                          GrassShrub.pct + Wetland.pct + 
                          LakeIWS.Ratio + factor(Ecoregion), 
                        data = LAGOS.MN.processed.Early)
summary(early.secchi.model1.7)

early.secchi.model1.8 <- lm(log(secchi) ~
                          Wetland.pct + 
                          LakeIWS.Ratio + factor(Ecoregion), 
                        data = LAGOS.MN.processed.Early)
summary(early.secchi.model1.8)

early.secchi.model1.9 <- lm(log(secchi) ~
                          LakeIWS.Ratio + factor(Ecoregion), 
                        data = LAGOS.MN.processed.Early)
summary(early.secchi.model1.9)

early.secchi.model1.10 <- lm(log(secchi) ~ factor(Ecoregion), 
                        data = LAGOS.MN.processed.Early)
summary(early.secchi.model1.10)
#nothing significant
AIC(early.secchi.model1, early.secchi.model1.2, early.secchi.model1.3, early.secchi.model1.4, 
    early.secchi.model1.5, early.secchi.model1.6, early.secchi.model1.7, early.secchi.model1.8, 
    early.secchi.model1.9, early.secchi.model1.10)





#Prime Season ######NOT WORKING. DONT KNOW WHY
prime.chla.model1 <- lm(log(chla) ~ IntenseUrban.pct + OpenUrban.pct + 
                          Barren.pct + Forest.pct + GrassShrub.pct + Wetland.pct + 
                          Pasture.pct + RowCrop.pct + LakeIWS.Ratio + factor(Ecoregion), 
                        data = LAGOS.MN.processed.Prime)
summary(prime.chla.model1)
step(prime.chla.model1) #inenseurban, openurban, forest, grassshrub, wetland, rowcrop, lakeratio, ecoregion

prime.chla.model1.2 <- lm(log(chla) ~ IntenseUrban.pct + OpenUrban.pct + 
                          Barren.pct + Forest.pct + GrassShrub.pct + Wetland.pct + 
                          RowCrop.pct + LakeIWS.Ratio + factor(Ecoregion), 
                        data = LAGOS.MN.processed.Prime)
summary(prime.chla.model1.2)

prime.chla.model1.3 <- lm(log(chla) ~ IntenseUrban.pct + OpenUrban.pct + 
                          Forest.pct + GrassShrub.pct + Wetland.pct + 
                          RowCrop.pct + LakeIWS.Ratio + factor(Ecoregion), 
                        data = LAGOS.MN.processed.Prime)
summary(prime.chla.model1.3)
#remaining variables significant, adjusted r-squared 0.2555
AIC(prime.chla.model1, prime.chla.model1.2, prime.chla.model1.3)
#lowest AIC model 3
plot(prime.chla.model1.3)


prime.secchi.model1 <- lm(log(secchi) ~ IntenseUrban.pct + OpenUrban.pct + 
                          Barren.pct + Forest.pct + GrassShrub.pct + Wetland.pct + 
                          Pasture.pct + RowCrop.pct + LakeIWS.Ratio + factor(Ecoregion), 
                        data = LAGOS.MN.processed.Prime)
summary(prime.secchi.model1)
step(prime.secchi.model1) #intenseurban, openurban, barren, forest, grassshrub, wetland, pasture, row crop, lakeratio, ecoregion

prime.secchi.model1.2 <- lm(log(secchi) ~ IntenseUrban.pct + OpenUrban.pct + 
                          Barren.pct + Forest.pct + GrassShrub.pct + Wetland.pct + 
                          RowCrop.pct + LakeIWS.Ratio + factor(Ecoregion), 
                        data = LAGOS.MN.processed.Prime)
summary(prime.secchi.model1.2)

prime.secchi.model1.3 <- lm(log(secchi) ~ IntenseUrban.pct + 
                          Barren.pct + Forest.pct + GrassShrub.pct + Wetland.pct + 
                          RowCrop.pct + LakeIWS.Ratio + factor(Ecoregion), 
                        data = LAGOS.MN.processed.Prime)
summary(prime.secchi.model1.3)

prime.secchi.model1.4 <- lm(log(secchi) ~ IntenseUrban.pct + 
                          Forest.pct + GrassShrub.pct + Wetland.pct + 
                          RowCrop.pct + LakeIWS.Ratio + factor(Ecoregion), 
                        data = LAGOS.MN.processed.Prime)
summary(prime.secchi.model1.4)

prime.secchi.model1.5 <- lm(log(secchi) ~ 
                          Forest.pct + GrassShrub.pct + Wetland.pct + 
                          RowCrop.pct + LakeIWS.Ratio + factor(Ecoregion), 
                        data = LAGOS.MN.processed.Prime)
summary(prime.secchi.model1.5)

prime.secchi.model1.6 <- lm(log(secchi) ~ 
                          GrassShrub.pct + Wetland.pct + 
                          RowCrop.pct + LakeIWS.Ratio + factor(Ecoregion), 
                        data = LAGOS.MN.processed.Prime)
summary(prime.secchi.model1.6)

prime.secchi.model1.7 <- lm(log(secchi) ~ 
                          Wetland.pct + 
                          RowCrop.pct + LakeIWS.Ratio + factor(Ecoregion), 
                        data = LAGOS.MN.processed.Prime)
summary(prime.secchi.model1.7)

prime.secchi.model1.8 <- lm(log(secchi) ~  
                          RowCrop.pct + LakeIWS.Ratio + factor(Ecoregion), 
                        data = LAGOS.MN.processed.Prime)
summary(prime.secchi.model1.8)

prime.secchi.model1.9 <- lm(log(secchi) ~  LakeIWS.Ratio + factor(Ecoregion), 
                        data = LAGOS.MN.processed.Prime)
summary(prime.secchi.model1.9)

prime.secchi.model1.10 <- lm(log(secchi) ~  factor(Ecoregion), 
                        data = LAGOS.MN.processed.Prime)
summary(prime.secchi.model1.10)
#nothing left significant

AIC(prime.secchi.model1, prime.secchi.model1.2, prime.secchi.model1.3, prime.secchi.model1.4, 
    prime.secchi.model1.5, prime.secchi.model1.6, prime.secchi.model1.7, prime.secchi.model1.8,
    prime.secchi.model1.9, prime.secchi.model1.10)
#lowest AIC model 1




#Late Season
late.chla.model1 <- lm(log(chla) ~ IntenseUrban.pct + OpenUrban.pct + 
                          Barren.pct + Forest.pct + GrassShrub.pct + Wetland.pct + 
                          Pasture.pct + RowCrop.pct + LakeIWS.Ratio + factor(Ecoregion), 
                        data = LAGOS.MN.processed.Late)
summary(late.chla.model1)
step(late.chla.model1) #intenseurban, openurban, forest, grassshrub, wetland, lakeratio, ecoregion

late.chla.model1.2 <- lm(log(chla) ~ IntenseUrban.pct + OpenUrban.pct + 
                          Forest.pct + GrassShrub.pct + Wetland.pct + 
                          Pasture.pct + RowCrop.pct + LakeIWS.Ratio + factor(Ecoregion), 
                        data = LAGOS.MN.processed.Late)
summary(late.chla.model1.2)

late.chla.model1.3 <- lm(log(chla) ~ IntenseUrban.pct + OpenUrban.pct + 
                          Forest.pct + GrassShrub.pct + Wetland.pct + 
                          Pasture.pct + LakeIWS.Ratio + factor(Ecoregion), 
                        data = LAGOS.MN.processed.Late)
summary(late.chla.model1.3)

late.chla.model1.4 <- lm(log(chla) ~ IntenseUrban.pct + OpenUrban.pct + 
                          Forest.pct + GrassShrub.pct + Wetland.pct + 
                          LakeIWS.Ratio + factor(Ecoregion), 
                        data = LAGOS.MN.processed.Late)
summary(late.chla.model1.4)
#remaining variables significant
#adjusted r-squared 0.1633
AIC(late.chla.model1, late.chla.model1.2, late.chla.model1.3, late.chla.model1.4)
#lowest AIC model 4
plot(late.chla.model1.4)


late.secchi.model1 <- lm(log(secchi) ~ IntenseUrban.pct + OpenUrban.pct + 
                          Barren.pct + Forest.pct + GrassShrub.pct + Wetland.pct + 
                          Pasture.pct + RowCrop.pct + LakeIWS.Ratio + factor(Ecoregion), 
                        data = LAGOS.MN.processed.Late)
summary(late.secchi.model1)
step(late.secchi.model1) #intenseurban, openurban, forest, grassshrub, lakeratio, ecoregion

late.secchi.model1.2 <- lm(log(secchi) ~ IntenseUrban.pct + OpenUrban.pct + 
                          Barren.pct + Forest.pct + GrassShrub.pct + Wetland.pct + 
                          Pasture.pct + LakeIWS.Ratio + factor(Ecoregion), 
                        data = LAGOS.MN.processed.Late)
summary(late.secchi.model1.2)

late.secchi.model1.3 <- lm(log(secchi) ~ IntenseUrban.pct + OpenUrban.pct + 
                          Barren.pct + Forest.pct + GrassShrub.pct + Wetland.pct + 
                          LakeIWS.Ratio + factor(Ecoregion), 
                        data = LAGOS.MN.processed.Late)
summary(late.secchi.model1.3)

late.secchi.model1.4 <- lm(log(secchi) ~ IntenseUrban.pct + OpenUrban.pct + 
                          Forest.pct + GrassShrub.pct + Wetland.pct + 
                          LakeIWS.Ratio + factor(Ecoregion), 
                        data = LAGOS.MN.processed.Late)
summary(late.secchi.model1.4)

late.secchi.model1.5 <- lm(log(secchi) ~ IntenseUrban.pct + OpenUrban.pct + 
                          Forest.pct + GrassShrub.pct + 
                          LakeIWS.Ratio + factor(Ecoregion), 
                        data = LAGOS.MN.processed.Late)
summary(late.secchi.model1.5)
#all remaining variables significant
#adjusted r-squared 0.171
AIC(late.secchi.model1, late.secchi.model1.2, late.secchi.model1.3, late.secchi.model1.4, late.secchi.model1.5)
#lowest AIC model 5
plot(late.secchi.model1.5)


```

FRAComment: the next chunk is a plot that we can use to show model results. If we dont need to show results with plots we can only just talk about coeficients and trends.

```{r}
#Saving the fitted values to the dataframe
LAGOS.MN.processed.Late$LM_Late_Secchi <- fitted(late.secchi.model1.5)

# Plotting the model
ggplot(LAGOS.MN.processed.Late, aes(x=LakeIWS.Ratio, y=log(secchi))) +
  geom_point(alpha = 0.3, size = 3) +
  geom_line(aes(y = LM_Late_Secchi), color ="red") +
  facet_wrap(~Ecoregion)
```



```{r Interaction models}
## Model 2

#Early Season
early.chla.model2 <- lm(log(chla) ~ IntenseUrban.pct*OpenUrban.pct* 
                          Barren.pct*Forest.pct*GrassShrub.pct*Wetland.pct* 
                          Pasture.pct*RowCrop.pct*LakeIWS.Ratio, 
                        data = LAGOS.MN.processed.Early)
summary(early.chla.model2)

early.secchi.model2 <- lm(log(secchi) ~ IntenseUrban.pct*OpenUrban.pct* 
                          Barren.pct*Forest.pct*GrassShrub.pct*Wetland.pct* 
                          Pasture.pct*RowCrop.pct*LakeIWS.Ratio, 
                        data = LAGOS.MN.processed.Early)
summary(early.secchi.model2)

#Prime Season ######NOT WORKING. DONT KNOW WHY
prime.chla.model2 <- lm(log(chla) ~ IntenseUrban.pct*OpenUrban.pct* 
                          Barren.pct*Forest.pct*GrassShrub.pct*Wetland.pct* 
                          Pasture.pct*RowCrop.pct*LakeIWS.Ratio, 
                        data = LAGOS.MN.processed.Prime)
summary(prime.chla.model2)

prime.secchi.model2 <- lm(log(secchi) ~ IntenseUrban.pct*OpenUrban.pct* 
                          Barren.pct*Forest.pct*GrassShrub.pct*Wetland.pct* 
                          Pasture.pct*RowCrop.pct*LakeIWS.Ratio, 
                        data = LAGOS.MN.processed.Prime)
summary(prime.secchi.model2)

#Late Season
late.chla.model2 <- lm(log(chla) ~ IntenseUrban.pct*OpenUrban.pct* 
                          Barren.pct*Forest.pct*GrassShrub.pct*Wetland.pct* 
                          Pasture.pct*RowCrop.pct*LakeIWS.Ratio, 
                        data = LAGOS.MN.processed.Late)
summary(late.chla.model2)

late.secchi.model2 <- lm(log(secchi) ~ IntenseUrban.pct*OpenUrban.pct* 
                          Barren.pct*Forest.pct*GrassShrub.pct*Wetland.pct* 
                          Pasture.pct*RowCrop.pct*LakeIWS.Ratio, 
                        data = LAGOS.MN.processed.Late)
summary(late.secchi.model2)




```


```{r No interaction mixed effects models}
####Early Season
###Chla
early.chla.model3 <- lmer(log(chla) ~ IntenseUrban.pct + OpenUrban.pct + 
                          Barren.pct + Forest.pct + GrassShrub.pct + Wetland.pct + 
                          Pasture.pct + RowCrop.pct + LakeIWS.Ratio + (1|Ecoregion), 
                        data = LAGOS.MN.processed.Early, REML = TRUE)
summary(early.chla.model3)
Anova(early.chla.model3)

early.chla.model3.2 <- lmer(log(chla) ~ IntenseUrban.pct + OpenUrban.pct + 
                          Forest.pct + GrassShrub.pct + Wetland.pct + 
                          Pasture.pct + RowCrop.pct + LakeIWS.Ratio + (1|Ecoregion), 
                        data = LAGOS.MN.processed.Early, REML = TRUE)
summary(early.chla.model3.2)
Anova(early.chla.model3.2)

early.chla.model3.3 <- lmer(log(chla) ~ OpenUrban.pct + 
                          Forest.pct + GrassShrub.pct + Wetland.pct + 
                          Pasture.pct + RowCrop.pct + LakeIWS.Ratio + (1|Ecoregion), 
                        data = LAGOS.MN.processed.Early, REML = TRUE)
summary(early.chla.model3.3)
Anova(early.chla.model3.3)

early.chla.model3.4 <- lmer(log(chla) ~ OpenUrban.pct + 
                          Forest.pct + Wetland.pct + 
                          Pasture.pct + RowCrop.pct + LakeIWS.Ratio + (1|Ecoregion), 
                        data = LAGOS.MN.processed.Early, REML = TRUE)
summary(early.chla.model3.4)
Anova(early.chla.model3.4)

early.chla.model3.5 <- lmer(log(chla) ~ OpenUrban.pct + 
                          Forest.pct +  
                          Pasture.pct + RowCrop.pct + LakeIWS.Ratio + (1|Ecoregion), 
                        data = LAGOS.MN.processed.Early, REML = TRUE)
summary(early.chla.model3.5)
Anova(early.chla.model3.5)
#all remaining variables significant
plot(early.chla.model3.5)
anova(early.chla.model3, early.chla.model3.2, early.chla.model3.3, 
      early.chla.model3.4, early.chla.model3.5)


#Saving the fitted values to the dataframe
LAGOS.MN.processed.Early$LMER_Early_Chla <- fitted(early.chla.model3)
#should this be the simplest model or the full model?

# Plotting the model
ggplot(LAGOS.MN.processed.Early, aes(x=LakeIWS.Ratio, y=log(chla))) +
  geom_point(alpha = 0.3, size = 3) +
  geom_line(aes(y = LMER_Early_Chla), color ="red") +
  facet_wrap(~Ecoregion)

plot(early.chla.model3)


###Secchi
early.secchi.model3 <- lmer(log(secchi) ~ IntenseUrban.pct + OpenUrban.pct + 
                          Barren.pct + Forest.pct + GrassShrub.pct + Wetland.pct + 
                          Pasture.pct + RowCrop.pct + LakeIWS.Ratio + (1|Ecoregion), 
                        data = LAGOS.MN.processed.Early)
summary(early.secchi.model3)
Anova(early.secchi.model3)

early.secchi.model3.2 <- lmer(log(secchi) ~ IntenseUrban.pct + OpenUrban.pct + 
                          Barren.pct + Forest.pct + GrassShrub.pct + Wetland.pct + 
                          Pasture.pct + LakeIWS.Ratio + (1|Ecoregion), 
                        data = LAGOS.MN.processed.Early)
summary(early.secchi.model3.2)
Anova(early.secchi.model3.2)

early.secchi.model3.3 <- lmer(log(secchi) ~ IntenseUrban.pct + OpenUrban.pct + 
                          Barren.pct + Forest.pct + GrassShrub.pct +  
                          Pasture.pct + LakeIWS.Ratio + (1|Ecoregion), 
                        data = LAGOS.MN.processed.Early)
summary(early.secchi.model3.3)
Anova(early.secchi.model3.3)

early.secchi.model3.4 <- lmer(log(secchi) ~ IntenseUrban.pct + OpenUrban.pct + 
                          Barren.pct + Forest.pct + GrassShrub.pct +  
                          LakeIWS.Ratio + (1|Ecoregion), 
                        data = LAGOS.MN.processed.Early)
summary(early.secchi.model3.4)
Anova(early.secchi.model3.4)

early.secchi.model3.5 <- lmer(log(secchi) ~ OpenUrban.pct + 
                          Barren.pct + Forest.pct + GrassShrub.pct +
                          LakeIWS.Ratio + (1|Ecoregion), 
                        data = LAGOS.MN.processed.Early)
summary(early.secchi.model3.5)
Anova(early.secchi.model3.5)
#remaining variables significant
plot(early.secchi.model3.5)
anova(early.secchi.model3, early.secchi.model3.2, early.secchi.model3.3,
      early.secchi.model3.4, early.secchi.model3.5)

#Saving the fitted values to the dataframe
LAGOS.MN.processed.Early$LMER_Early_Secchi <- fitted(early.secchi.model3)

# Plotting the model
ggplot(LAGOS.MN.processed.Early, aes(x=LakeIWS.Ratio, y=log(secchi))) +
  geom_point(alpha = 0.3, size = 3) +
  geom_line(aes(y = LMER_Early_Secchi), color ="blue") +
  facet_wrap(~Ecoregion)

plot(early.secchi.model3)



####Prime Season
###Chla
prime.chla.model3 <- lmer(log(chla) ~ IntenseUrban.pct + OpenUrban.pct + 
                          Barren.pct + Forest.pct + GrassShrub.pct + Wetland.pct + 
                          Pasture.pct + RowCrop.pct + LakeIWS.Ratio + (1|Ecoregion), 
                        data = LAGOS.MN.processed.Prime)
summary(prime.chla.model3)
Anova(prime.chla.model3)

prime.chla.model3.2 <- lmer(log(chla) ~ IntenseUrban.pct + OpenUrban.pct + 
                          Barren.pct + Forest.pct + GrassShrub.pct + Wetland.pct + 
                          RowCrop.pct + LakeIWS.Ratio + (1|Ecoregion), 
                        data = LAGOS.MN.processed.Prime)
summary(prime.chla.model3.2)
Anova(prime.chla.model3.2)

prime.chla.model3.3 <- lmer(log(chla) ~ IntenseUrban.pct + OpenUrban.pct + 
                          Forest.pct + GrassShrub.pct + Wetland.pct + 
                          RowCrop.pct + LakeIWS.Ratio + (1|Ecoregion), 
                        data = LAGOS.MN.processed.Prime)
summary(prime.chla.model3.3)
Anova(prime.chla.model3.3)
#remaining variables significant
plot(prime.chla.model3.3)

#Saving the fitted values to the dataframe
LAGOS.MN.processed.Prime$LMER_Prime_Chla <- fitted(prime.chla.model3)

# Plotting the model
ggplot(LAGOS.MN.processed.Prime, aes(x=LakeIWS.Ratio, y=log(chla))) +
  geom_point(alpha = 0.3, size = 3) +
  geom_line(aes(y = LMER_Prime_Chla), color ="red") +
  facet_wrap(~Ecoregion)

plot(prime.chla.model3)

### Secchi
prime.secchi.model3 <- lmer(log(secchi) ~ IntenseUrban.pct + OpenUrban.pct + 
                          Barren.pct + Forest.pct + GrassShrub.pct + Wetland.pct + 
                          Pasture.pct + RowCrop.pct + LakeIWS.Ratio + (1|Ecoregion), 
                        data = LAGOS.MN.processed.Prime)
summary(prime.secchi.model3)
Anova(prime.secchi.model3)

prime.secchi.model3.2 <- lmer(log(secchi) ~ IntenseUrban.pct + OpenUrban.pct + 
                          Barren.pct + Forest.pct + GrassShrub.pct + 
                          Pasture.pct + RowCrop.pct + LakeIWS.Ratio + (1|Ecoregion), 
                        data = LAGOS.MN.processed.Prime)
summary(prime.secchi.model3.2)
Anova(prime.secchi.model3.2)
#remaining variables significant
plot(prime.secchi.model3.2)
anova(prime.secchi.model3, prime.secchi.model3.2)

#Saving the fitted values to the dataframe
LAGOS.MN.processed.Prime$LMER_Prime_Secchi <- fitted(prime.secchi.model3)

# Plotting the model
ggplot(LAGOS.MN.processed.Prime, aes(x=LakeIWS.Ratio, y=log(secchi))) +
  geom_point(alpha = 0.3, size = 3) +
  geom_line(aes(y = LMER_Prime_Secchi), color ="blue") +
  facet_wrap(~Ecoregion)

plot(prime.secchi.model3)













#### Late Season
###Chla
late.chla.model3 <- lmer(log(chla) ~ IntenseUrban.pct + OpenUrban.pct + 
                          Barren.pct + Forest.pct + GrassShrub.pct + Wetland.pct + 
                          Pasture.pct + RowCrop.pct + LakeIWS.Ratio + (1|Ecoregion), 
                        data = LAGOS.MN.processed.Late)
summary(late.chla.model3)
Anova(late.chla.model3)

late.chla.model3.2 <- lmer(log(chla) ~ IntenseUrban.pct + OpenUrban.pct + 
                          Forest.pct + GrassShrub.pct + Wetland.pct + 
                          Pasture.pct + RowCrop.pct + LakeIWS.Ratio + (1|Ecoregion), 
                        data = LAGOS.MN.processed.Late)
summary(late.chla.model3.2)
Anova(late.chla.model3.2)

late.chla.model3.3 <- lmer(log(chla) ~ IntenseUrban.pct + OpenUrban.pct + 
                          Forest.pct + GrassShrub.pct + Wetland.pct + 
                          Pasture.pct + LakeIWS.Ratio + (1|Ecoregion), 
                        data = LAGOS.MN.processed.Late)
summary(late.chla.model3.3)
Anova(late.chla.model3.3)

late.chla.model3.4 <- lmer(log(chla) ~ IntenseUrban.pct + OpenUrban.pct + 
                          Forest.pct + GrassShrub.pct + Wetland.pct + 
                          LakeIWS.Ratio + (1|Ecoregion), 
                        data = LAGOS.MN.processed.Late)
summary(late.chla.model3.4)
Anova(late.chla.model3.4)
#all remaining variables significant
plot(late.chla.model3.4)


#Saving the fitted values to the dataframe
LAGOS.MN.processed.Late$LMER_Late_Chla <- fitted(late.chla.model3)

# Plotting the model
ggplot(LAGOS.MN.processed.Late, aes(x=LakeIWS.Ratio, y=log(chla))) +
  geom_point(alpha = 0.3, size = 3) +
  geom_line(aes(y = LMER_Late_Chla), color ="red") +
  facet_wrap(~Ecoregion)

plot(late.chla.model3)






###Secchi

late.secchi.model3 <- lmer(log(secchi) ~ IntenseUrban.pct + OpenUrban.pct + 
                          Barren.pct + Forest.pct + GrassShrub.pct + Wetland.pct + 
                          Pasture.pct + RowCrop.pct + LakeIWS.Ratio + (1|Ecoregion), 
                        data = LAGOS.MN.processed.Late)
summary(late.secchi.model3)
Anova(late.secchi.model3)

late.secchi.model3.2 <- lmer(log(secchi) ~ IntenseUrban.pct + OpenUrban.pct + 
                          Barren.pct + Forest.pct + GrassShrub.pct + Wetland.pct + 
                          Pasture.pct + LakeIWS.Ratio + (1|Ecoregion), 
                        data = LAGOS.MN.processed.Late)
summary(late.secchi.model3.2)
Anova(late.secchi.model3.2)

late.secchi.model3.2 <- lmer(log(secchi) ~ IntenseUrban.pct + OpenUrban.pct + 
                          Barren.pct + Forest.pct + GrassShrub.pct + Wetland.pct + 
                          Pasture.pct + LakeIWS.Ratio + (1|Ecoregion), 
                        data = LAGOS.MN.processed.Late)
summary(late.secchi.model3.2)
Anova(late.secchi.model3.2)

late.secchi.model3.2 <- lmer(log(secchi) ~ IntenseUrban.pct + OpenUrban.pct + 
                          Barren.pct + Forest.pct + GrassShrub.pct + Wetland.pct + 
                          Pasture.pct + LakeIWS.Ratio + (1|Ecoregion), 
                        data = LAGOS.MN.processed.Late)
summary(late.secchi.model3.2)
Anova(late.secchi.model3.2)

late.secchi.model3.3 <- lmer(log(secchi) ~ IntenseUrban.pct + OpenUrban.pct + 
                          Barren.pct + Forest.pct + GrassShrub.pct + Wetland.pct + 
                          LakeIWS.Ratio + (1|Ecoregion), 
                        data = LAGOS.MN.processed.Late)
summary(late.secchi.model3.3)
Anova(late.secchi.model3.3)

late.secchi.model3.4 <- lmer(log(secchi) ~ IntenseUrban.pct + OpenUrban.pct + 
                          Forest.pct + GrassShrub.pct + Wetland.pct + 
                          LakeIWS.Ratio + (1|Ecoregion), 
                        data = LAGOS.MN.processed.Late)
summary(late.secchi.model3.4)
Anova(late.secchi.model3.4)

late.secchi.model3.5 <- lmer(log(secchi) ~ IntenseUrban.pct + OpenUrban.pct + 
                          Forest.pct + GrassShrub.pct + 
                          LakeIWS.Ratio + (1|Ecoregion), 
                        data = LAGOS.MN.processed.Late)
summary(late.secchi.model3.5)
Anova(late.secchi.model3.5)
#remaining variables significant
plot(late.secchi.model3.5)
anova(late.secchi.model3, late.secchi.model3.2, late.secchi.model3.3, 
      late.secchi.model3.4, late.secchi.model3.5)

#Saving the fitted values to the dataframe
LAGOS.MN.processed.Late$LMER_Late_Secchi <- fitted(late.secchi.model3)

# Plotting the model
ggplot(LAGOS.MN.processed.Late, aes(x=LakeIWS.Ratio, y=log(secchi))) +
  geom_point(alpha = 0.3, size = 3) +
  geom_line(aes(y = LMER_Late_Secchi), color ="blue") +
  facet_wrap(~Ecoregion)

plot(late.secchi.model3)





```
Early Chla model:
* pasture and row crop direct/positive relationship, openurban, forest, and ratio indirect/negative relationship
* log(chla) = -0.010769(open urban) +  -0.015262(forest) + 0.008496(pasture) + 0.003201(rowcrop) + -0.308617(ratio) + 2.479692

Early Secchi model:
* open urban, barren, forest, grassshrub, and ratio direct/positive relationship
* log(secchi) = 0.012368(open urban) + 0.019564(barren) + 0.012288(forest) +0.010243(grass shrub) +  0.214416(ratio) + -0.045792

Prime Chla model: 
* intenseurban, openurban, forest, grassshrub, wetland, rowcrop, and ratio indirect/negative relationsihp
* log(chla) = -0.0100841(intense urban) + -0.0252362(open urban) + -0.0244790(forest) + -0.0252642(grass shrub) + -0.0125302(wetland) + -0.0069355(rowcrop) + -0.4174341(ratio) + 3.8867381

Prime Secchi model:
* intense urban, openurban, barren, forest, grassshrub, pasture, rowcrop, and ratio direct/positive relationship
* log(secchi) = 0.0042302(intense urban) + 0.0155867(open urban) + 0.0075966(barren) + 0.0159693(forest) + 0.0144579(grass shrub) + 0.0033298(pasture) + 0.0046399(rowcrop) + 0.3943152(ratio) + -0.5862860

Late Chla model: 
* Intenseurban, openurban, forest, grassshrub, wetland, and ratio indirect/negative relationship
* log(chla) = -0.013306(intense urban) + -0.023772(open urban) + -0.024870(forest) + -0.028149(grass shrub) + -0.011284(wetland) + -0.263348(ratio) + 3.665338

Late Secchi model:
* Intenseurban, openurban, forest, grassshurb, and ratio indirect/negative relationship
* log(secchi) = 0.004109(intense urban) + 0.014590(open urban) + 0.016406(forest) + 0.017732(grass shrub) + 0.250633(ratio) + -0.245145

```{r results table}
MixedResults.table <- read.csv("./Output/MixedResultsTable.csv")
library(knitr)
kable(MixedResults.table)
```

