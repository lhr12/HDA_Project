---
title: "Lindsay_LAGOS_Exploration"
author: "Lindsay Roth"
date: "11/4/2019"
output: pdf_document
editor_options: 
  chunk_output_type: console
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r Setup_Load_Data}
getwd()

#load packages
library(tidyverse)
library(lubridate)
library(LAGOSNE)

#load LAGOS data
LAGOSdata <- lagosne_load()

# creating specific lagos files
LAGOSstate <- LAGOSdata$state
LAGOSlocus <- LAGOSdata$locus
LAGOSnutrient <- LAGOSdata$epi_nutr
LAGOSiwslulc <- LAGOSdata$iws.lulc


```


```{r, Checking_Each_State_for_Nutrient_Data}
#checking each state for nutrient data

#State 1: Maine
LAGOSlocus.Maine <- LAGOSlocus %>% filter(state_zoneid == "State_1")
LAGOSnutrient.Maine <- LAGOSlocus.Maine %>%
  left_join(LAGOSnutrient, by = "lagoslakeid") 
sapply(LAGOSnutrient.Maine, summary)

#State 2: Mass
LAGOSlocus.Mass <- LAGOSlocus %>% filter(state_zoneid == "State_2")
LAGOSnutrient.Mass <- LAGOSlocus.Mass %>%
  left_join(LAGOSnutrient, by = "lagoslakeid") 

#State 3: Michigan
LAGOSlocus.Mich <- LAGOSlocus %>% filter (state_zoneid == "State_3")
LAGOSnutrient.Mich <- LAGOSlocus.Mich %>%
  left_join(LAGOSnutrient, by = "lagoslakeid") 

#State 4: New Jersey
LAGOSlocus.NJ <- LAGOSlocus %>% filter (state_zoneid == "State_4")
LAGOSnutrient.NJ <- LAGOSlocus.NJ %>%
  left_join(LAGOSnutrient, by = "lagoslakeid") 

#State 5: New York
LAGOSlocus.NY <- LAGOSlocus %>% filter (state_zoneid == "State_5")
LAGOSnutrient.NY <- LAGOSlocus.NY %>%
  left_join(LAGOSnutrient, by = "lagoslakeid") 

#State 6: Ohio
LAGOSlocus.Ohio <- LAGOSlocus %>% filter (state_zoneid == "State_6")
LAGOSnutrient.Ohio <- LAGOSlocus.Ohio %>%
  left_join(LAGOSnutrient, by = "lagoslakeid") 

#State 7: Pennsylvania
LAGOSlocus.Penn <- LAGOSlocus %>% filter (state_zoneid == "State_7")
LAGOSnutrient.Penn <- LAGOSlocus.Penn %>%
  left_join(LAGOSnutrient, by = "lagoslakeid") 

#State 8: Rhode Island
LAGOSlocus.RI <- LAGOSlocus %>% filter (state_zoneid == "State_8")
LAGOSnutrient.RI <- LAGOSlocus.RI %>%
  left_join(LAGOSnutrient, by = "lagoslakeid") 

#State 9: Wisconsin
LAGOSlocus.WI <- LAGOSlocus %>% filter (state_zoneid == "State_9")
LAGOSnutrient.WI <- LAGOSlocus.WI %>%
  left_join(LAGOSnutrient, by = "lagoslakeid") 

#State 10: Connecticut
LAGOSlocus.CT <- LAGOSlocus %>% filter (state_zoneid == "State_10")
LAGOSnutrient.CT <- LAGOSlocus.CT %>%
  left_join(LAGOSnutrient, by = "lagoslakeid") 

#State 11: Illinois
LAGOSlocus.IL <- LAGOSlocus %>% filter (state_zoneid == "State_11")
LAGOSnutrient.IL <- LAGOSlocus.IL %>%
  left_join(LAGOSnutrient, by = "lagoslakeid") 

#State 12: Indiana
LAGOSlocus.Indi <- LAGOSlocus %>% filter (state_zoneid == "State_12")
LAGOSnutrient.Indi <- LAGOSlocus.Indi %>%
  left_join(LAGOSnutrient, by = "lagoslakeid") 

#State 13: Iowa
LAGOSlocus.Iowa <- LAGOSlocus %>% filter (state_zoneid == "State_13")
LAGOSnutrient.Iowa <- LAGOSlocus.Iowa %>%
  left_join(LAGOSnutrient, by = "lagoslakeid")

#State 14: Minnesota
LAGOSlocus.MN <- LAGOSlocus %>% filter (state_zoneid == "State_14")
LAGOSnutrient.MN <- LAGOSlocus.MN %>%
  left_join(LAGOSnutrient, by = "lagoslakeid") 

#State 15: Missouri
LAGOSlocus.Mis <- LAGOSlocus %>% filter (state_zoneid == "State_15")
LAGOSnutrient.Mis <- LAGOSlocus.Mis %>%
  left_join(LAGOSnutrient, by = "lagoslakeid") 

#State 16: New Hampshire
LAGOSlocus.NH <- LAGOSlocus %>% filter (state_zoneid == "State_16")
LAGOSnutrient.NH <- LAGOSlocus.NH %>%
  left_join(LAGOSnutrient, by = "lagoslakeid") 

#State 17: Vermont
LAGOSlocus.VT <- LAGOSlocus %>% filter (state_zoneid == "State_17")
LAGOSnutrient.VT <- LAGOSlocus.VT %>%
  left_join(LAGOSnutrient, by = "lagoslakeid") 

```


```{r, Joining_MN_Nutrient_lulc}

#joining MN locus with iwslulc
LAGOSiws.MN <- LAGOSlocus.MN %>% left_join(LAGOSiwslulc, by = "lagoslakeid")


##selecting 2011 lulc
LAGOSiws2011.MN <- LAGOSiws.MN %>% 
  select(lagoslakeid,state_zoneid,
         iws_nlcd2011_pct_11, iws_nlcd2011_pct_21, iws_nlcd2011_pct_22,
         iws_nlcd2011_pct_23, iws_nlcd2011_pct_24, iws_nlcd2011_pct_31,
         iws_nlcd2011_pct_41, iws_nlcd2011_pct_42, iws_nlcd2011_pct_43,
         iws_nlcd2011_pct_52, iws_nlcd2011_pct_71, iws_nlcd2011_pct_81,
         iws_nlcd2011_pct_82, iws_nlcd2011_pct_90, iws_nlcd2011_pct_95)

#1 = urban, 2 = ag, 3 = rangeland, 4 = forest, 5 = water
#6 = wetland, 7 = barren land, 8 = tundra, 9 = snow/ice


```


```{r, Filter_Nutrient_Dates}
#filtering state nutrient data
LAGOSnutrient.MN.skinny <- LAGOSnutrient.MN %>%
  filter(sampledate > "2009-12-31" & sampledate < "2013-01-01")

sapply(LAGOSnutrient.MN.skinny, summary)
```


```{r, Joined_MN_df}
##Joining iws.lulc and nutrient
LAGOSiws.nutrient.2011.MN <-  left_join(LAGOSnutrient.MN.skinny, LAGOSiws2011.MN, by = c("lagoslakeid")) 

LAGOSiws.nutrient.2011.MN <- LAGOSiws.nutrient.2011.MN %>%
  select(lagoslakeid, nhd_lat, nhd_long, lake_area_ha, lake_perim_meters,
         iws_zoneid, state_zoneid.x, elevation_m, sampledate, chla,secchi, 
         iws_nlcd2011_pct_11, iws_nlcd2011_pct_21, iws_nlcd2011_pct_22, 
         iws_nlcd2011_pct_23, iws_nlcd2011_pct_24, iws_nlcd2011_pct_31, 
         iws_nlcd2011_pct_41, iws_nlcd2011_pct_42, iws_nlcd2011_pct_43, 
         iws_nlcd2011_pct_52, iws_nlcd2011_pct_71, iws_nlcd2011_pct_81, 
         iws_nlcd2011_pct_82, iws_nlcd2011_pct_90, iws_nlcd2011_pct_95)

sapply(LAGOSiws.nutrient.2011.MN, summary)



```


```{r, Visualize_data}
# Looking at the data

ggplot(LAGOSiws.nutrient.2011.MN, aes(x = sampledate, y = tn, color = lagoslakeid)) +
  scale_color_viridis_c(option = "plasma") +
geom_line() 

ggplot(LAGOSiws.nutrient.2011.MN, aes(x = sampledate, y = tp, color = lagoslakeid)) +
  scale_color_viridis_c(option = "plasma") +
geom_line() 

ggplot(LAGOSiws.nutrient.2011.MN, aes(x = sampledate, y = secchi, color = lagoslakeid)) +
  scale_color_viridis_c(option = "plasma") +
geom_line() 

ggplot(LAGOSiws.nutrient.2011.MN, aes(x = sampledate, y = chla, color = lagoslakeid)) +
  scale_color_viridis_c(option = "plasma") +
geom_line() 

```


```{r Create_Full_df}

LAGOS.MN.processed <- LAGOSiws.nutrient.2011.MN %>%
  mutate(Urban.pct = iws_nlcd2011_pct_11,
         Ag.pct = iws_nlcd2011_pct_21 + iws_nlcd2011_pct_22 +
           iws_nlcd2011_pct_23 + iws_nlcd2011_pct_24, 
         Natural.pct = iws_nlcd2011_pct_31 + iws_nlcd2011_pct_41 + 
           iws_nlcd2011_pct_42 + iws_nlcd2011_pct_43 + 
           iws_nlcd2011_pct_71 + iws_nlcd2011_pct_81 + 
           iws_nlcd2011_pct_82) %>%
  select(-c(iws_nlcd2011_pct_11, iws_nlcd2011_pct_21, iws_nlcd2011_pct_22, 
            iws_nlcd2011_pct_23, iws_nlcd2011_pct_24, iws_nlcd2011_pct_31, 
            iws_nlcd2011_pct_41, iws_nlcd2011_pct_42, iws_nlcd2011_pct_43, 
            iws_nlcd2011_pct_52, iws_nlcd2011_pct_71, iws_nlcd2011_pct_81, 
            iws_nlcd2011_pct_82, iws_nlcd2011_pct_90, iws_nlcd2011_pct_95)) %>%
  na.omit()

sapply(LAGOS.MN.processed, summary)

write.csv(x =  LAGOS.MN.processed, row.names = FALSE,
          file =  "./data/raw/LAGOS_MN_Full.csv")

```


```{r Visualize_Data_Round_2}
ggplot(LAGOS.MN.processed, aes(x = sampledate, y = secchi, color = lagoslakeid)) +
  scale_color_viridis_c(option = "plasma") +
geom_line() 

ggplot(LAGOS.MN.processed, aes(x = sampledate, y = chla, color = lagoslakeid)) +
  scale_color_viridis_c(option = "plasma") +
geom_line() 

ggplot(LAGOS.MN.processed, aes(x = secchi, y = Urban.pct, color = as.numeric(sampledate))) +
  scale_color_viridis_c(option = "plasma") +
  geom_point()

ggplot(LAGOS.MN.processed, aes(x = secchi, y = Ag.pct, color = as.numeric(sampledate))) +
  scale_color_viridis_c(option = "plasma") +
  geom_point()

ggplot(LAGOS.MN.processed, aes(x = secchi, y = Natural.pct, color = as.numeric(sampledate))) +
  scale_color_viridis_c(option = "plasma") +
  geom_point()

ggplot(LAGOS.MN.processed, aes(x = chla, y = Urban.pct, color = as.numeric(sampledate))) +
  scale_color_viridis_c(option = "plasma") +
  geom_point()

ggplot(LAGOS.MN.processed, aes(x = chla, y = Ag.pct, color = as.numeric(sampledate))) +
  scale_color_viridis_c(option = "plasma") +
  geom_point()

ggplot(LAGOS.MN.processed, aes(x = chla, y = Natural.pct, color = as.numeric(sampledate))) +
  scale_color_viridis_c(option = "plasma") +
  geom_point()



```

